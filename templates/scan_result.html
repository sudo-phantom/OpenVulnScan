{% extends "base.html" %}
{% block content %}
<h1>Scan Results</h1>
<h2>Scan ID: {{ scan_id }}</h2>
<p><strong>Started at:</strong> {{ started_at }}</p>
<p><strong>Completed at:</strong> {{ completed_at or 'In progress' }}</p>

<h3>Targets:</h3>
<ul>
    {% for target in targets %}
        <li>{{ target }}</li>
    {% endfor %}
</ul>

<h4>Findings:</h4>
<ul>
    {% if scan.findings %}
    {% for finding in scan.findings %}
    <h3>{{ finding.hostname }} - {{ finding.ip_address }}</h3>
    <p>{{ finding.raw_data }}</p>
    
    {% for cve in finding.cves %}
        <div>
            <p><strong>CVE ID: </strong>{{ cve.cve_id }}</p>
            <p><strong>Description: </strong>{{ cve.summary }}</p>
        </div>
    {% endfor %}
    {% endfor %}

    {% else %}
        <li>No findings</li>
    {% endif %}
</ul>

<p><a href="/scan/{{ scan_id }}/pdf">Download PDF Report</a></p>
<p><a href="/">Back to Scan History</a></p>
{% endblock %}
